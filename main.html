<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logger de Input</title>
    <link rel="stylesheet" href="style.css">
    <script src="./helper.js" defer></script>
    <script src="bc-api.js"></script>
</head>

<body>
    <div class="container">
        <h1>Logger de Input</h1>

        <div class="input-container">
            <label for="textInput">Digite algo:</label>
            <input type="text" id="textInput" placeholder="Comece a digitar...">
            <div class="status" id="status"></div>
        </div>

        <div class="logs-container">
            <div class="logs-title">
                <h2>Logs de Atividade</h2>
                <button id="clearLogs">Limpar Logs</button>
            </div>

            <ul id="logList">
                <li class="empty-logs">Nenhum registro ainda. Digite algo no campo acima.</li>
            </ul>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const textInput = document.getElementById('textInput');
            const logList = document.getElementById('logList');
            const clearLogsBtn = document.getElementById('clearLogs');
            const statusEl = document.getElementById('status');

            let timeoutId = null;

            // Carregar logs do localStorage se existirem
            loadLogsFromStorage();

            // Adicionar evento de input para detectar digitação
            textInput.addEventListener('input', function () {
                statusEl.textContent = "Digitando...";

                // Limpar o timeout anterior se existir
                if (timeoutId) {
                    clearTimeout(timeoutId);
                }

                // Configurar um novo timeout para 300ms
                timeoutId = setTimeout(() => {
                    if (textInput.value.trim() !== '') {
                        addLog(textInput.value);
                    }
                    statusEl.textContent = "";
                }, 300);
            });

            // Evento para limpar os logs
            clearLogsBtn.addEventListener('click', function () {
                if (confirm('Tem certeza que deseja limpar todos os logs?')) {
                    logList.innerHTML = '<li class="empty-logs">Nenhum registro ainda. Digite algo no campo acima.</li>';
                    localStorage.removeItem('inputLogs');
                }
            });

            // Focar no input quando a página carregar
            textInput.focus();

            // Invocar a função processarCotacaoMoeda e mostrar resultado no console
            processarCotacaoMoeda('USD', '09-15-2025').then(console.log);
        });
    </script>
</body>

</html>